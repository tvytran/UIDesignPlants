{% extends "base.html" %}

{% block title %}Browse Plants{% endblock %}

{% block content %}
<div class="container py-5">
    <h1 class="mb-4 text-success">Explore Our Plants</h1>

    <!-- Search Bar -->
    <div class="input-group mb-4 shadow-sm">
        <span class="input-group-text bg-white border-end-0"><i class="bi bi-search"></i></span>
        <input type="text" id="plantSearch" class="form-control border-start-0" placeholder="Search for plants by name..." aria-label="Search plants">
    </div>

    <!-- Plant Grid -->
    <div id="plantList" class="row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 g-4">
        {% for plant in plants.values() %}
        <div class="col plant-card-container"> {# Wrapper for easier JS targeting #}
            <div class="card h-100 shadow-sm" style="overflow: hidden;">
                 <img src="{{ url_for('static', filename='images/' + plant['image']) }}" class="card-img-top" alt="{{ plant['name'] }}" style="height: 15rem; object-fit: cover;">
                <div class="card-body d-flex flex-column">
                    <h5 class="card-title">
                         <a href="{{ url_for('plant_detail', plant_id=plant['id']) }}" class="text-decoration-none text-dark stretched-link">{{ plant['name'] }}</a>
                    </h5>
                    <p class="card-text text-muted small">{{ plant['short_description'] }}</p>
                    {# Optional: Add price or other quick info here #}
                    {# <span class="mt-auto badge bg-light text-success fs-6 align-self-start">${{ plant['price'] }}</span> #}
                </div>
                 {# Optional: Add a subtle footer #}
                 {# <div class="card-footer bg-transparent border-top-0">
                    <small class="text-muted">{{ plant['category'] }}</small>
                 </div> #}
            </div>
        </div>
        {% endfor %}
    </div>
    <div id="noResults" class="alert alert-warning mt-4 d-none" role="alert">
      No plants found matching your search.
    </div>
</div>

{% endblock %}

{% block scripts %}
<script>
$(document).ready(function(){
    $('#plantSearch').on('keyup', function() {
        var searchTerm = $(this).val().toLowerCase();
        var found = false;
        $('#plantList .plant-card-container').each(function() {
            var plantName = $(this).find('.card-title a').text().toLowerCase();
            if (plantName.includes(searchTerm)) {
                $(this).show();
                found = true;
            } else {
                $(this).hide();
            }
        });

        // Show/hide 'no results' message
        if (!found && searchTerm !== '') {
            $('#noResults').removeClass('d-none');
        } else {
             $('#noResults').addClass('d-none');
        }
        // Ensure message hides if search is cleared
        if(searchTerm === '') {
             $('#noResults').addClass('d-none');
             $('#plantList .plant-card-container').show(); // Show all again
        }
    });
});
</script>
{% endblock %}  